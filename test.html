<!DOCTYPE html>
<html>
    <head>
        <title>UVO</title>
        <link rel="stylesheet" href="test.css">
        <script>
            
        </script>
    </head>
    <body>
        <div class="container">
            <div class="inpt">
                <!--input der kører functionen 'update' hver gang der er nyt input-->
                <input id="ip1" oninput="update(), doit()">
                <input id="ip2" oninput="update(), doit()">
                <!--input der ikke kører nogen function da det er vores output-->
                <input id="ip3">
            </div>
            <button class="button" onclick="clicked()">
                nut
            </button>
        </div>
        <div id="popup">
            <p id="output"></p>
        </div>
        <script>
            // lang: js
            var i = false;
            document.getElementById("popup").style.display = "none";
            function clicked() {
                if (i == false) {
                    document.getElementById("popup").style.display = "block";
                    i = true;
                } else {
                    document.getElementById("popup").style.display = "none";
                    i = false;
                };   
            }

            // Bestemmelse af variabler 'stof' og 'masse' så de er globale og kan ændres inde i en funktion
            var masse;
            var molar;
            var stof;

            async function update() {
                // variabel angivning som tager input fra 'ip1' og angiver det som input1
                var input1 = document.getElementById("ip1").value;
                // variabel angivning som tager elementet fra input1 og isolerer alle numeraler ved hjælp af regex
                var num1 = input1.replace(/[^\d\.]+/g, '');
                // variabel angivning som tager elementet fra input1 og isolerer alle ikke-numeraler ved hjælp af regex
                var alp1 = input1.replace(/[^\D\.]+/g, '');

                // gentagelse af foroven bare med input2
                var input2 = document.getElementById("ip2").value;
                var num2 = input2.replace(/[^\d\.]+/g, '');
                var alp2 = input2.replace(/[^\D\.]+/g, '');              

                // Genkendelse af enhed og formel
                gram1: if (alp1.includes("g")==true) {
                    if (alp1.includes("mikro")==true || alp1.includes("µ")==true || alp1.includes("u")==true) {
                        console.log("mikrogram")
                        masse = 0.001;
                        break gram1;
                    }
                    else if (alp1.includes("m")==true || alp1.includes("milli")==true) {
                        console.log("milligram")
                        masse = 0.01;
                    } 
                    else if (alp1.includes("d")==true) {
                        console.log("decigram")
                        masse = 0.1;
                    }
                    else if (alp1.includes("k")==true) {
                        console.log("kilogram")
                        masse = 1000;
                    }
                    else {
                        console.log("gram")
                        masse = 1;
                    }
                }

                mol1: if (alp1.includes("mol")==true) {
                    if (alp1.includes("mikro")==true || alp1.includes("µ")==true || alp1.includes("u")==true) {
                        console.log("mikromol")
                        stof = 0.001;
                    }
                    else if (alp1.includes("d")==true) {
                        console.log("decimol")
                        stof = 0.1;
                    }
                    else if (alp1.includes("mm")==false) {
                        console.log("mol")
                        stof = 1;
                        break mol1;
                    }
                    else if (alp1.includes("m")==true || alp1.includes("milli")==true) {
                        console.log("millimol")
                        stof = 0.01;
                    }
                }

                // Gentagende kode. Jeg hader det, men jeg ved ikke hvad jeg skal gøre ved det. Faktum er at det fungerer.
                gram2: if (alp2.includes("g")==true) {
                    if (alp2.includes("mikro")==true || alp2.includes("µ")==true || alp2.includes("u")==true) {
                        console.log("mikrogram")
                        masse = 0.001;
                        break gram2
                    }
                    else if (alp2.includes("m")==true || alp2.includes("milli")==true) {
                        console.log("milligram")
                        masse = 0.01;
                    } 
                    else if (alp2.includes("d")==true) {
                        console.log("decigram")
                        masse = 0.1;
                    }
                    else if (alp2.includes("k")==true) {
                        console.log("kilogram")
                        masse = 1000;
                    }
                    else {
                        console.log("gram")
                        masse = 1;
                    }
                }

                mol2: if (alp2.includes("mol")==true) {
                    if (alp2.includes("mikro")==true || alp2.includes("µ")==true || alp2.includes("u")==true) {
                        console.log("mikromol")
                        stof = 0.001;
                    }
                    else if (alp2.includes("d")==true) {
                        console.log("decimol")
                        stof = 0.1;
                    }
                    else if (alp2.includes("mm")==false) {
                        console.log("mol")
                        stof = 1;
                        break mol2;
                    }
                    else if (alp2.includes("m")==true || alp2.includes("milli")==true) {
                        console.log("millimol")
                        stof = 0.01;
                    }
                }
            }

            async function doit() {
                // siden 'stof' og 'masse' er bestemt inden i en anden function, så er den blevet bestemt globalt
                if (masse !== undefined && stof !== undefined) {
                    console.log("masse & stof")
                    masse = undefined;
                    molar = undefined;
                    stof = undefined;
                } else if (masse !== undefined && molar !== undefined) {
                    console.log("mass & molar mass")
                    masse = undefined;
                    molar = undefined;
                    stof = undefined;
                } else if (stof !== undefined && molar !== undefined) {
                    console.log("amount & molar mass")
                    masse = undefined;
                    molar = undefined;
                    stof = undefined;
                } else {
                    console.log("not enough")
                    masse = undefined;
                    molar = undefined;
                    stof = undefined;
                    return false;
                }
            }

            // endlang
        </script>
    </body>
</html>
